using System;
using System.Runtime.InteropServices;

namespace MyProject  
{
    class Program    
    {
        static void Main(string[] args)  
        {
            const string CommandPlayerDefaultAttack = "1";
            const string CommandFireball = "2";
            const string CommandExplosion = "3";
            const string CommandHeal = "4";

            Random random = new Random();
            bool isGameRun = true;
            bool isFireballUsed = false;
            int playerMaxHealth = 500;
            int playerHealth = playerMaxHealth;
            int playerDefaultAttackDamage = 125;
            int playerMaxManapool = 150;
            int playerManaPool = playerMaxManapool;
            int playerFireballDamage = 250;
            int playerFireballManaCost = 50;
            int playerExplosionDamage = 150;
            int playerExplosionManaCost = 25;
            int playerHealAmountOfRestoredHealth = 200;
            int playerHealAmountOfRestoredMana = 75;
            int playerHealQuantityUses = 3; 
            int bossHealth = 2000;
            int bossDamage;
            int bossMaxDamage = 90;
            int bossMinDamage = 50;
        
            while (isGameRun)
            {   
                Console.WriteLine("Сражение с боссом!");
                Console.WriteLine($"У босса осталось:{bossHealth} здоровья");
                Console.WriteLine($"Мана игрока: {playerManaPool}");
                Console.WriteLine($"Здоровье игрока: {playerHealth}");
                Console.WriteLine("");
                Console.WriteLine($"Ваш ход");
                Console.WriteLine($"{CommandPlayerDefaultAttack} - Обычная атака");
                Console.WriteLine($"Наносит {playerDefaultAttackDamage} урона");
                Console.WriteLine($"{CommandFireball} - Огненный шар");
                Console.WriteLine($"Наносит {playerFireballDamage} урона и тратит {playerFireballManaCost} маны");
                Console.WriteLine($"{CommandExplosion} - Взрыв, можно использовать только после огненного шара!");
                Console.WriteLine($"Наносит {playerExplosionDamage} урона и тратит {playerExplosionManaCost} маны");
                Console.WriteLine($"{CommandHeal} - Лечение");
                Console.WriteLine($"Восстанавливает {playerHealAmountOfRestoredHealth} здоровья и {playerHealAmountOfRestoredMana} маны");
                string userTurn = Console.ReadLine();
                
                switch(userTurn)
                {   
                    case CommandPlayerDefaultAttack:                       
                        bossHealth -= playerDefaultAttackDamage;
                        
                        Console.Clear();
                        Console.WriteLine($"Вы нанесли боссу {playerDefaultAttackDamage} урона!");
                        Console.WriteLine($"У босса осталось {bossHealth} здоровья");
                        Console.WriteLine("");
                        break;

                    case CommandFireball:
        
                        if (playerManaPool >= playerFireballManaCost)
                        {
                            bossHealth -= playerFireballDamage;
                            playerManaPool -= playerFireballManaCost;
                            isFireballUsed = true;

                            Console.Clear();
                            Console.WriteLine($"Вы нанесли боссу {playerFireballDamage} урона!");
                            Console.WriteLine($"У босса осталось {bossHealth} здоровья");
                            Console.WriteLine("");
                        }
                        else
                        {
                            Console.WriteLine("У вас недостаточно маны!");
                        }
                        break;

                    case CommandExplosion:

                        if(isFireballUsed && playerManaPool >= playerExplosionManaCost)
                        {
                            isFireballUsed = false;
                            playerManaPool -= playerExplosionManaCost;
                            bossHealth -= playerExplosionDamage;

                            Console.Clear();
                            Console.WriteLine($"Вы нанесли боссу {playerExplosionDamage} урона!");
                            Console.WriteLine($"У босса осталось {bossHealth} здоровья");
                            Console.WriteLine("");
                        }
                        else
                        {
                            Console.Clear();
                            Console.WriteLine("Вы не использовали огненный шар или у вас недостаточно маны!");
                        }
                        break;

                    case CommandHeal:

                        if(playerHealQuantityUses > 0)
                        {
                            Console.Clear();
                            Console.WriteLine("Вы использовали лечение");
                            Console.WriteLine($"Вы восстановили себе {playerHealAmountOfRestoredHealth} здоровья и {playerHealAmountOfRestoredMana} маны");
                            Console.WriteLine("");
                            if(playerHealth + playerHealAmountOfRestoredHealth > playerMaxHealth)
                            {
                                playerHealth = playerMaxHealth;
                            }
                            else
                            {
                                playerHealth += playerHealAmountOfRestoredHealth;
                            }
                            if(playerManaPool + playerHealAmountOfRestoredMana > playerMaxManapool)
                            {
                                playerManaPool = playerMaxManapool;
                            }
                            else    
                            {
                                playerManaPool += playerHealAmountOfRestoredMana;
                            }
                            playerHealQuantityUses--;

                            Console.WriteLine($"Ваше текущее здоровье: {playerHealth}");
                            Console.WriteLine($"Ваша текущая мана: {playerManaPool}");
                            Console.WriteLine("");
                        }
                        else
                        {
                            Console.WriteLine("У вас закончились использования лечения");
                        }
                        break;

                    default:
                        break;
                }
                bossDamage = random.Next(bossMinDamage, bossMaxDamage);

                playerHealth -= bossDamage;
                Console.WriteLine($"Босс нанёс вам {bossDamage}");
                Console.WriteLine($"У вас осталось {playerHealth} здоровья");
                Console.WriteLine();
                Console.WriteLine("Нажмите любую клавишу чтобы продолжить");
                Console.ReadLine();

                if (bossHealth <= 0 || playerHealth <= 0)
                {
                    isGameRun = false;
                }
            }
            if (bossHealth <= 0 && playerHealth <= 0)
                {
                    Console.WriteLine("Ничья!");
                }
                else if (playerHealth <= 0)
                {
                    isGameRun = false;
                    Console.WriteLine("Вы проиграли");
                }
                else if (bossHealth <= 0)
                {
                    isGameRun = false;
                    Console.WriteLine("Вы победили босса!");
                }
        }
    }
}
